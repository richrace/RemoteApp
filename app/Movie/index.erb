<div data-role="page">

	<div data-id="head" data-role="header" data-position="fixed">
    <a href="#" onClick="reload();" class="ui-btn-left" data-iconpos="notext" data-icon="refresh">
		</a>
		<h1>Movies</h1>
    <a href="#" class="ui-btn-right" data-iconpos="right" data-icon="gear" data-transition="slideup">
      Sort
    </a>
	</div>
	
	<script>
		function reload() {
			$.get("<%= url_for :action => :update_list %>");
		}
		
		function getThumb(movieid) {
			$.post("<%= url_for :action => :get_thumb %>", {"movieid":movieid});
		}
		
		function updateList(movies) {
			if (movies != null) {
				var list = document.getElementById('content_list');
				if (list.hasChildNodes()) {
					while (list.childNodes.length >= 1) {
						list.removeChild(list.firstChild);       
					} 
				}
				for (movie in movies) {
					var newLi = document.createElement('li');
					newLi.innerHTML = "<a href=\"" + movies[movie].url + "\"><img id="+movies[movie].xlib_id+" />" + movies[movie].label + "</a>";
					list.appendChild(newLi);
					getThumb(movies[movie].xlib_id);
				}
				$(list).listview('refresh');
				$.fixedToolbars.show(true);
			}
		}
		
		function addThumb(movieid, filename) {
			document.getElementById(movieid).src = filename;
		}
		
		$(document).ready(function () { 
			reload();
		});
		
	</script>

  <div data-role="content">
    <ul id="content_list" data-role="listview" data-filter="true">
    
    </ul>

  </div>
	
	<div data-id="tabbar" data-role="footer" data-position="fixed" class="nav-cust">
		<div data-role="navbar" class="nav-cust" data-grid="d">
			<ul>
				<li><a href="<%= url_for :controller => :Controls %>" id="controls" data-icon="custom">Controls</a></li>
				<li><a href="<%= url_for :controller => :Movie %>" id="movies" data-icon="custom" class="ui-btn-active ui-state-persist">Movies</a></li>
				<li><a href="#" id="shows" data-icon="custom">TV Shows</a></li>
				<li><a href="#" id="playlist" data-icon="custom">Playlist</a></li>
				<li><a href="<%= url_for :controller => :More %>" id="more" data-icon="custom">More</a></li>
			</ul>
		</div>
	</div>

</div>
