<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Class: XbmcConnect</title>

  <link rel="stylesheet" href="./rdoc.css" type="text/css" media="screen" />

  <script src="./js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="./js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="./js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="./js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="./app/helpers/xbmc/xbmc_connect_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="app/helpers/xbmc/xbmc_connect.rb">app/helpers/xbmc/xbmc_connect.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link"><a href="Object.html">Object</a></p>
        
      </div>
      

      

      
      <!-- Namespace Contents -->
      <div id="namespace-list-section" class="section">
        <h3 class="section-header">Namespace</h3>
        <ul class="link-list">
          
          <li><span class="type">CLASS</span> <a href="XbmcConnect/Command.html">XbmcConnect::Command</a></li>
          
        </ul>
      </div>
      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-api_loaded-3F">::api_loaded?</a></li>
          
          <li><a href="#method-c-async_connect">::async_connect</a></li>
          
          <li><a href="#method-c-download_file">::download_file</a></li>
          
          <li><a href="#method-c-load_api">::load_api</a></li>
          
          <li><a href="#method-c-load_commands">::load_commands</a></li>
          
          <li><a href="#method-c-load_version">::load_version</a></li>
          
          <li><a href="#method-c-parse_commands_v2">::parse_commands_v2</a></li>
          
          <li><a href="#method-c-parse_commands_v4">::parse_commands_v4</a></li>
          
          <li><a href="#method-c-setup">::setup</a></li>
          
          <li><a href="#method-c-sync_connect">::sync_connect</a></li>
          
        </ul>
      </div>
      

      
      <!-- Included Modules -->
      <div id="includes-section" class="section">
        <h3 class="section-header">Included Modules</h3>
        <ul class="link-list">
        
        
          <li><a class="include" href="ApplicationHelper.html">ApplicationHelper</a></li>
        
        
        
          <li><a class="include" href="BrowserHelper.html">BrowserHelper</a></li>
        
        
        
          <li><a class="include" href="ErrorHelper.html">ErrorHelper</a></li>
        
        
        </ul>
      </div>
      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="./LICENSE.html">LICENSE</a></li>
        
          <li class="file"><a href="./Rakefile.html">Rakefile</a></li>
        
          <li class="file"><a href="./app/helpers/xbmc/xbmc-client-LICENSE.html">xbmc-client-LICENSE</a></li>
        
          <li class="file"><a href="./public/images/IUI_LICENSE_txt.html">IUI_LICENSE.txt</a></li>
        
          <li class="file"><a href="./public/jquery-toastmessage-plugin/LICENSE.html">LICENSE</a></li>
        
          <li class="file"><a href="./public/jquery-toastmessage-plugin/NOTICE.html">NOTICE</a></li>
        
          <li class="file"><a href="./rhoconfig_txt.html">rhoconfig.txt</a></li>
        
          <li class="file"><a href="./rholog_txt.html">rholog.txt</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="./images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="./ApiV4.html">ApiV4</a></li>
        
          <li><a href="./ApiV4/Application.html">ApiV4::Application</a></li>
        
          <li><a href="./ApiV4/Input.html">ApiV4::Input</a></li>
        
          <li><a href="./ApiV4/Playback.html">ApiV4::Playback</a></li>
        
          <li><a href="./ApiV4/Playlist.html">ApiV4::Playlist</a></li>
        
          <li><a href="./ApiV4/VideoLibrary.html">ApiV4::VideoLibrary</a></li>
        
          <li><a href="./Api.html">Api</a></li>
        
          <li><a href="./Api/V2.html">Api::V2</a></li>
        
          <li><a href="./Api/V4.html">Api::V4</a></li>
        
          <li><a href="./ApiV2.html">ApiV2</a></li>
        
          <li><a href="./ApiV2/Playback.html">ApiV2::Playback</a></li>
        
          <li><a href="./ApiV2/VideoLibrary.html">ApiV2::VideoLibrary</a></li>
        
          <li><a href="./XbmcConnect.html">XbmcConnect</a></li>
        
          <li><a href="./XbmcConnect/Command.html">XbmcConnect::Command</a></li>
        
          <li><a href="./AppApplication.html">AppApplication</a></li>
        
          <li><a href="./Application4.html">Application4</a></li>
        
          <li><a href="./ApplicationHelper.html">ApplicationHelper</a></li>
        
          <li><a href="./BarcodeScanController.html">BarcodeScanController</a></li>
        
          <li><a href="./BrowserHelper.html">BrowserHelper</a></li>
        
          <li><a href="./CommandsController.html">CommandsController</a></li>
        
          <li><a href="./CommandsHelper.html">CommandsHelper</a></li>
        
          <li><a href="./Control2.html">Control2</a></li>
        
          <li><a href="./Control4.html">Control4</a></li>
        
          <li><a href="./Controls.html">Controls</a></li>
        
          <li><a href="./ControlsController.html">ControlsController</a></li>
        
          <li><a href="./DownloadHelper.html">DownloadHelper</a></li>
        
          <li><a href="./ErrorHelper.html">ErrorHelper</a></li>
        
          <li><a href="./GeoController.html">GeoController</a></li>
        
          <li><a href="./GeoHelper.html">GeoHelper</a></li>
        
          <li><a href="./Input4.html">Input4</a></li>
        
          <li><a href="./MethodHelper.html">MethodHelper</a></li>
        
          <li><a href="./MoreController.html">MoreController</a></li>
        
          <li><a href="./Movie.html">Movie</a></li>
        
          <li><a href="./MovieController.html">MovieController</a></li>
        
          <li><a href="./MovieHelper.html">MovieHelper</a></li>
        
          <li><a href="./ObjHelper.html">ObjHelper</a></li>
        
          <li><a href="./Object.html">Object</a></li>
        
          <li><a href="./Playlist4.html">Playlist4</a></li>
        
          <li><a href="./PlaylistController.html">PlaylistController</a></li>
        
          <li><a href="./PlaylistHelper.html">PlaylistHelper</a></li>
        
          <li><a href="./Product.html">Product</a></li>
        
          <li><a href="./ProductController.html">ProductController</a></li>
        
          <li><a href="./ProductHelper.html">ProductHelper</a></li>
        
          <li><a href="./SpecRunner.html">SpecRunner</a></li>
        
          <li><a href="./SpecRunnerController.html">SpecRunnerController</a></li>
        
          <li><a href="./TempClass.html">TempClass</a></li>
        
          <li><a href="./TvEpisodeHelper.html">TvEpisodeHelper</a></li>
        
          <li><a href="./TvSeasonHelper.html">TvSeasonHelper</a></li>
        
          <li><a href="./TvShowHelper.html">TvShowHelper</a></li>
        
          <li><a href="./Tvepisode.html">Tvepisode</a></li>
        
          <li><a href="./TvepisodeController.html">TvepisodeController</a></li>
        
          <li><a href="./Tvseason.html">Tvseason</a></li>
        
          <li><a href="./TvseasonController.html">TvseasonController</a></li>
        
          <li><a href="./Tvshow.html">Tvshow</a></li>
        
          <li><a href="./TvshowController.html">TvshowController</a></li>
        
          <li><a href="./VideoLibrary2.html">VideoLibrary2</a></li>
        
          <li><a href="./VideoLibrary4.html">VideoLibrary4</a></li>
        
          <li><a href="./XbmcAppHelper.html">XbmcAppHelper</a></li>
        
          <li><a href="./XbmcConfig.html">XbmcConfig</a></li>
        
          <li><a href="./XbmcConfigController.html">XbmcConfigController</a></li>
        
          <li><a href="./XbmcConfigHelper.html">XbmcConfigHelper</a></li>
        
          <li><a href="./XbmcController.html">XbmcController</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">XbmcConnect</h1>

    <div id="description" class="description">
      
<p><a href="XbmcConnect.html">XbmcConnect</a> class heavily modified by
Richard Race to be used within the Rhodes  Framework. Original by Christoph
Olszowka - <a
href="https://github.com/colszowka/xbmc-client">github.com/colszowka/xbmc-client</a></p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="api_loaded-3F-method" class="method-detail ">
          <a name="method-c-api_loaded-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">api_loaded?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Checks the array of loaded APIs to see if the current XBMC API has been
loaded.</p>
            

            
            <div class="method-source-code" id="api_loaded-3F-source">
<pre>
<span class="ruby-comment"># File app/helpers/xbmc/xbmc_connect.rb, line 186</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">api_loaded?</span> 
  <span class="ruby-identifier">xbmc</span> = <span class="ruby-constant">XbmcConfigHelper</span>.<span class="ruby-identifier">current_config</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">xbmc</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">error_handle</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-constant">XbmcConnect</span>.<span class="ruby-identifier">loaded_apis</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">xbmc</span>.<span class="ruby-identifier">version</span>.<span class="ruby-identifier">to_i</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">else</span> 
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- api_loaded-3F-source -->
            
          </div>

          

          
        </div><!-- api_loaded-3F-method -->

      
        <div id="async_connect-method" class="method-detail ">
          <a name="method-c-async_connect"></a>

          
          <div class="method-heading">
            <span class="method-name">async_connect</span><span
              class="method-args">(callback, method, params={})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Main method used to connecting to the XBMC server; this is asynchronous
Uses the Rho::AsyncHTTP.post method as the JSON RPC commands and params are
contained  within the body of the post. params parameter can be null. Will
not return any data, that is what the callback is used for. The callback
need to be  a URL for a controller.</p>
            

            
            <div class="method-source-code" id="async_connect-source">
<pre>
<span class="ruby-comment"># File app/helpers/xbmc/xbmc_connect.rb, line 60</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">async_connect</span>(<span class="ruby-identifier">callback</span>, <span class="ruby-identifier">method</span>, <span class="ruby-identifier">params</span>={})
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;**** CONNECTING&quot;</span>
  <span class="ruby-identifier">body</span> = {
    <span class="ruby-value">:jsonrpc</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;2.0&quot;</span>, 
    <span class="ruby-value">:params</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>, 
    <span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;1&quot;</span>,
    <span class="ruby-value">:method</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">method</span>
  }.<span class="ruby-identifier">to_json</span>
  <span class="ruby-constant">Rho</span><span class="ruby-operator">::</span><span class="ruby-constant">AsyncHttp</span>.<span class="ruby-identifier">post</span>(
    <span class="ruby-value">:url</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@url</span>,
    <span class="ruby-value">:authentication</span> =<span class="ruby-operator">&gt;</span> {
      <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:basic</span>,
      <span class="ruby-value">:username</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@uname</span>,
      <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@pass</span>
    },
    <span class="ruby-value">:body</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">body</span>,
    <span class="ruby-value">:callback</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">callback</span>
  )
  <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;SENDING ---- #{body}&quot;</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- async_connect-source -->
            
          </div>

          

          
        </div><!-- async_connect-method -->

      
        <div id="download_file-method" class="method-detail ">
          <a name="method-c-download_file"></a>

          
          <div class="method-heading">
            <span class="method-name">download_file</span><span
              class="method-args">(address, filename, callback, param)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>An asynchronous method for downloading files (images) from a given address.
The address is the XBMC “vfs://special/xxxx” format to be added onto the
base address: “<a
href="http://localhost:8080/vfs://special/xxxx">localhost:8080/vfs://special/xxxx</a>”
All the parameters are required. The outcome of the downloading of the file
will be sent to the callback method.</p>
            

            
            <div class="method-source-code" id="download_file-source">
<pre>
<span class="ruby-comment"># File app/helpers/xbmc/xbmc_connect.rb, line 107</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">download_file</span>(<span class="ruby-identifier">address</span>, <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">callback</span>, <span class="ruby-identifier">param</span>) 
  <span class="ruby-constant">Rho</span><span class="ruby-operator">::</span><span class="ruby-constant">AsyncHttp</span>.<span class="ruby-identifier">download_file</span>(
    <span class="ruby-value">:url</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@base</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">address</span>,
    <span class="ruby-value">:authentication</span> =<span class="ruby-operator">&gt;</span> {
      <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:basic</span>,
      <span class="ruby-value">:username</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@uname</span>,
      <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@pass</span>
    },
    <span class="ruby-value">:filename</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">filename</span>,
    <span class="ruby-value">:headers</span> =<span class="ruby-operator">&gt;</span> {},
    <span class="ruby-value">:callback</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">callback</span>,
    <span class="ruby-value">:callback_param</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">param</span>
  )
<span class="ruby-keyword">end</span></pre>
            </div><!-- download_file-source -->
            
          </div>

          

          
        </div><!-- download_file-method -->

      
        <div id="load_api-method" class="method-detail ">
          <a name="method-c-load_api"></a>

          
          <div class="method-heading">
            <span class="method-name">load_api</span><span
              class="method-args">(callback="app/Xbmc/version")</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Main command for loading the API. Will get the current version of the XBMC
server before loading the commands. Can accept a different Callback.</p>
            

            
            <div class="method-source-code" id="load_api-source">
<pre>
<span class="ruby-comment"># File app/helpers/xbmc/xbmc_connect.rb, line 124</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_api</span>(<span class="ruby-identifier">callback</span>=<span class="ruby-string">&quot;app/Xbmc/version&quot;</span>)
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;***** GETTING VERSION ******&quot;</span>
  <span class="ruby-keyword">if</span> <span class="ruby-constant">XbmcConfigHelper</span>.<span class="ruby-identifier">current_config</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">error_handle</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">async_connect</span>(<span class="ruby-identifier">callback</span>, <span class="ruby-string">&quot;JSONRPC.Version&quot;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- load_api-source -->
            
          </div>

          

          
        </div><!-- load_api-method -->

      
        <div id="load_commands-method" class="method-detail ">
          <a name="method-c-load_commands"></a>

          
          <div class="method-heading">
            <span class="method-name">load_commands</span><span
              class="method-args">(params)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Loads the commands depending on the version. Double checks that the API is
loaded correctly, then sets that the API is loaded into the load_apis
array.</p>
            

            
            <div class="method-source-code" id="load_commands-source">
<pre>
<span class="ruby-comment"># File app/helpers/xbmc/xbmc_connect.rb, line 146</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_commands</span>(<span class="ruby-identifier">params</span>)
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;*********** LOADING COMMANDS ************&quot;</span>
  <span class="ruby-ivar">@commands</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">cur_version</span> = <span class="ruby-constant">XbmcConfigHelper</span>.<span class="ruby-identifier">current_config</span>.<span class="ruby-identifier">version</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">cur_version</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Api</span><span class="ruby-operator">::</span><span class="ruby-constant">V2</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span>
    <span class="ruby-identifier">parse_commands_v2</span>(<span class="ruby-identifier">params</span>[<span class="ruby-string">'body'</span>])
  <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">cur_version</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Api</span><span class="ruby-operator">::</span><span class="ruby-constant">V4</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span>) <span class="ruby-operator">||</span> (<span class="ruby-identifier">cur_version</span> <span class="ruby-operator">==</span> <span class="ruby-value">3</span>)
    <span class="ruby-identifier">parse_commands_v4</span>(<span class="ruby-identifier">params</span>[<span class="ruby-string">'body'</span>])
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@commands</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">command</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">command</span>.<span class="ruby-identifier">send</span> <span class="ruby-value">:define_method!</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">xbmc</span> = <span class="ruby-constant">XbmcConfigHelper</span>.<span class="ruby-identifier">current_config</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-constant">XbmcConnect</span>.<span class="ruby-identifier">loaded_apis</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">xbmc</span>.<span class="ruby-identifier">version</span>)
    <span class="ruby-constant">XbmcConnect</span>.<span class="ruby-identifier">loaded_apis</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xbmc</span>.<span class="ruby-identifier">version</span> 
    <span class="ruby-constant">XbmcConnect</span>.<span class="ruby-identifier">error</span> = {<span class="ruby-value">:error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">XbmcConnect</span><span class="ruby-operator">::</span><span class="ruby-constant">ERRORNO</span>, <span class="ruby-value">:msg</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Everything went as planned&quot;</span>}
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- load_commands-source -->
            
          </div>

          

          
        </div><!-- load_commands-method -->

      
        <div id="load_version-method" class="method-detail ">
          <a name="method-c-load_version"></a>

          
          <div class="method-heading">
            <span class="method-name">load_version</span><span
              class="method-args">(params)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Assigns the version of the current XBMC server. Calls the Introspect method
to load  the available commands.</p>
            

            
            <div class="method-source-code" id="load_version-source">
<pre>
<span class="ruby-comment"># File app/helpers/xbmc/xbmc_connect.rb, line 135</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_version</span>(<span class="ruby-identifier">params</span>)
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;********** LOADING VERSION **********&quot;</span>
  <span class="ruby-identifier">xbmc</span> = <span class="ruby-constant">XbmcConfigHelper</span>.<span class="ruby-identifier">current_config</span>
  <span class="ruby-identifier">xbmc</span>.<span class="ruby-identifier">version</span> = <span class="ruby-identifier">params</span>[<span class="ruby-string">'body'</span>].<span class="ruby-identifier">with_indifferent_access</span>[<span class="ruby-value">:result</span>][<span class="ruby-value">:version</span>]
  <span class="ruby-identifier">xbmc</span>.<span class="ruby-identifier">save</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;****** LOADING API ********&quot;</span>
  <span class="ruby-identifier">async_connect</span>(<span class="ruby-string">&quot;app/Xbmc/commands&quot;</span>,<span class="ruby-string">&quot;JSONRPC.Introspect&quot;</span>, <span class="ruby-value">:getdescriptions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- load_version-source -->
            
          </div>

          

          
        </div><!-- load_version-method -->

      
        <div id="parse_commands_v2-method" class="method-detail ">
          <a name="method-c-parse_commands_v2"></a>

          
          <div class="method-heading">
            <span class="method-name">parse_commands_v2</span><span
              class="method-args">(body)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Parses the commands for XBMC Dhrama Version 10.1. Uses the structure that
was in place from the  original class.</p>
            

            
            <div class="method-source-code" id="parse_commands_v2-source">
<pre>
<span class="ruby-comment"># File app/helpers/xbmc/xbmc_connect.rb, line 180</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parse_commands_v2</span>(<span class="ruby-identifier">body</span>)
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;***** LOADS V2 Commands *****&quot;</span>
  <span class="ruby-ivar">@commands</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">body</span>.<span class="ruby-identifier">with_indifferent_access</span>[<span class="ruby-value">:result</span>][<span class="ruby-value">:commands</span>].<span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-constant">XbmcConnect</span><span class="ruby-operator">::</span><span class="ruby-constant">Command</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">c</span>)}
<span class="ruby-keyword">end</span></pre>
            </div><!-- parse_commands_v2-source -->
            
          </div>

          

          
        </div><!-- parse_commands_v2-method -->

      
        <div id="parse_commands_v4-method" class="method-detail ">
          <a name="method-c-parse_commands_v4"></a>

          
          <div class="method-heading">
            <span class="method-name">parse_commands_v4</span><span
              class="method-args">(body)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Parses the commands for XBMC Eden Version 11. Uses the structure that was
in place from the  original class.</p>
            

            
            <div class="method-source-code" id="parse_commands_v4-source">
<pre>
<span class="ruby-comment"># File app/helpers/xbmc/xbmc_connect.rb, line 167</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parse_commands_v4</span>(<span class="ruby-identifier">body</span>)
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;***** LOADS V4 Commands ******&quot;</span>
  <span class="ruby-ivar">@commands</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">body</span>.<span class="ruby-identifier">with_indifferent_access</span>[<span class="ruby-value">:result</span>][<span class="ruby-value">:methods</span>].<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">attrList</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">at</span>(<span class="ruby-value">1</span>)
    <span class="ruby-comment"># Add command name to the specification</span>
    <span class="ruby-identifier">attrList</span>[<span class="ruby-string">&quot;command&quot;</span>] = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">at</span>(<span class="ruby-value">0</span>)
    <span class="ruby-comment"># Process the command as usual</span>
    <span class="ruby-constant">XbmcConnect</span><span class="ruby-operator">::</span><span class="ruby-constant">Command</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">attrList</span>)
  }
<span class="ruby-keyword">end</span></pre>
            </div><!-- parse_commands_v4-source -->
            
          </div>

          

          
        </div><!-- parse_commands_v4-method -->

      
        <div id="setup-method" class="method-detail ">
          <a name="method-c-setup"></a>

          
          <div class="method-heading">
            <span class="method-name">setup</span><span
              class="method-args">(add, port, usr="", pass="")</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets up the networking information to be used throughout this class. usr
and pass can be nill. The address can contain ‘http://’ or not, it will be
stripped if it is present.</p>
            

            
            <div class="method-source-code" id="setup-source">
<pre>
<span class="ruby-comment"># File app/helpers/xbmc/xbmc_connect.rb, line 43</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">setup</span>(<span class="ruby-identifier">add</span>, <span class="ruby-identifier">port</span>, <span class="ruby-identifier">usr</span>=<span class="ruby-string">&quot;&quot;</span>, <span class="ruby-identifier">pass</span>=<span class="ruby-string">&quot;&quot;</span>)
  <span class="ruby-comment"># Regex to strip leading 'http://'</span>
  <span class="ruby-identifier">add</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/[Hh][Tt][Tt][Pp]:\/\//</span>,<span class="ruby-string">&quot;&quot;</span>)
  <span class="ruby-comment"># This is the URL for connecting to the JSON RPC API</span>
  <span class="ruby-ivar">@url</span> = <span class="ruby-string">&quot;http://&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">add</span> <span class="ruby-operator">+</span> <span class="ruby-string">':'</span> <span class="ruby-operator">+</span> <span class="ruby-node">&quot;#{port}&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-string">'/jsonrpc'</span>
  <span class="ruby-comment"># This is needed for downloading of images.</span>
  <span class="ruby-ivar">@base</span> = <span class="ruby-string">&quot;http://&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">add</span> <span class="ruby-operator">+</span> <span class="ruby-string">':'</span> <span class="ruby-operator">+</span> <span class="ruby-node">&quot;#{port}/&quot;</span>
  <span class="ruby-ivar">@uname</span> = <span class="ruby-identifier">usr</span>
  <span class="ruby-ivar">@pass</span> = <span class="ruby-identifier">pass</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- setup-source -->
            
          </div>

          

          
        </div><!-- setup-method -->

      
        <div id="sync_connect-method" class="method-detail ">
          <a name="method-c-sync_connect"></a>

          
          <div class="method-heading">
            <span class="method-name">sync_connect</span><span
              class="method-args">(method, params={})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>A synchronous method used to connecting to the XBMC server. Uses the
Rho::AsyncHTTP.post method as well (see <a
href="XbmcConnect.html#method-c-async_connect">async_connect</a> method).
There is no callback needed and will return data.</p>
            

            
            <div class="method-source-code" id="sync_connect-source">
<pre>
<span class="ruby-comment"># File app/helpers/xbmc/xbmc_connect.rb, line 84</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">sync_connect</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">params</span>={})
  <span class="ruby-identifier">response</span> = <span class="ruby-constant">Rho</span><span class="ruby-operator">::</span><span class="ruby-constant">AsyncHttp</span>.<span class="ruby-identifier">post</span>(
    <span class="ruby-value">:url</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@url</span>,
    <span class="ruby-value">:authentication</span> =<span class="ruby-operator">&gt;</span> {
      <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:basic</span>,
      <span class="ruby-value">:username</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@uname</span>,
      <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@pass</span>
    },
    <span class="ruby-value">:body</span> =<span class="ruby-operator">&gt;</span> {
      <span class="ruby-value">:jsonrpc</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;2.0&quot;</span>, 
      <span class="ruby-value">:params</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>, 
      <span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;1&quot;</span>,
      <span class="ruby-value">:method</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">method</span>
    }.<span class="ruby-identifier">to_json</span>
  )
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">response</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- sync_connect-source -->
            
          </div>

          

          
        </div><!-- sync_connect-method -->

      
      </div><!-- public-class-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

