<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Module: TvSeasonHelper</title>

  <link rel="stylesheet" href="./rdoc.css" type="text/css" media="screen" />

  <script src="./js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="./js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="./js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="./js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="module">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="./app/helpers/tv_season_helper_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="app/helpers/tv_season_helper.rb">app/helpers/tv_season_helper.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-i-find_season">#find_season</a></li>
          
          <li><a href="#method-i-find_seasons">#find_seasons</a></li>
          
          <li><a href="#method-i-handle_new_seasons">#handle_new_seasons</a></li>
          
          <li><a href="#method-i-handle_removed_seasons">#handle_removed_seasons</a></li>
          
          <li><a href="#method-i-sync_seasons">#sync_seasons</a></li>
          
          <li><a href="#method-i-update_episodes">#update_episodes</a></li>
          
          <li><a href="#method-i-update_seasons_helper">#update_seasons_helper</a></li>
          
        </ul>
      </div>
      

      
      <!-- Included Modules -->
      <div id="includes-section" class="section">
        <h3 class="section-header">Included Modules</h3>
        <ul class="link-list">
        
        
          <li><a class="include" href="XbmcConfigHelper.html">XbmcConfigHelper</a></li>
        
        
        
          <li><a class="include" href="MethodHelper.html">MethodHelper</a></li>
        
        
        
          <li><a class="include" href="TvEpisodeHelper.html">TvEpisodeHelper</a></li>
        
        
        
          <li><a class="include" href="DownloadHelper.html">DownloadHelper</a></li>
        
        
        </ul>
      </div>
      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="./LICENSE.html">LICENSE</a></li>
        
          <li class="file"><a href="./Rakefile.html">Rakefile</a></li>
        
          <li class="file"><a href="./app/helpers/xbmc/xbmc-client-LICENSE.html">xbmc-client-LICENSE</a></li>
        
          <li class="file"><a href="./public/images/IUI_LICENSE_txt.html">IUI_LICENSE.txt</a></li>
        
          <li class="file"><a href="./public/jquery-toastmessage-plugin/LICENSE.html">LICENSE</a></li>
        
          <li class="file"><a href="./public/jquery-toastmessage-plugin/NOTICE.html">NOTICE</a></li>
        
          <li class="file"><a href="./rhoconfig_txt.html">rhoconfig.txt</a></li>
        
          <li class="file"><a href="./rholog_txt.html">rholog.txt</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="./images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="./ApiV4.html">ApiV4</a></li>
        
          <li><a href="./ApiV4/Application.html">ApiV4::Application</a></li>
        
          <li><a href="./ApiV4/Input.html">ApiV4::Input</a></li>
        
          <li><a href="./ApiV4/Playback.html">ApiV4::Playback</a></li>
        
          <li><a href="./ApiV4/Playlist.html">ApiV4::Playlist</a></li>
        
          <li><a href="./ApiV4/VideoLibrary.html">ApiV4::VideoLibrary</a></li>
        
          <li><a href="./Api.html">Api</a></li>
        
          <li><a href="./Api/V2.html">Api::V2</a></li>
        
          <li><a href="./Api/V4.html">Api::V4</a></li>
        
          <li><a href="./ApiV2.html">ApiV2</a></li>
        
          <li><a href="./ApiV2/Playback.html">ApiV2::Playback</a></li>
        
          <li><a href="./ApiV2/VideoLibrary.html">ApiV2::VideoLibrary</a></li>
        
          <li><a href="./XbmcConnect.html">XbmcConnect</a></li>
        
          <li><a href="./XbmcConnect/Command.html">XbmcConnect::Command</a></li>
        
          <li><a href="./AppApplication.html">AppApplication</a></li>
        
          <li><a href="./Application4.html">Application4</a></li>
        
          <li><a href="./ApplicationHelper.html">ApplicationHelper</a></li>
        
          <li><a href="./BarcodeScanController.html">BarcodeScanController</a></li>
        
          <li><a href="./BrowserHelper.html">BrowserHelper</a></li>
        
          <li><a href="./CommandsController.html">CommandsController</a></li>
        
          <li><a href="./CommandsHelper.html">CommandsHelper</a></li>
        
          <li><a href="./Control2.html">Control2</a></li>
        
          <li><a href="./Control4.html">Control4</a></li>
        
          <li><a href="./Controls.html">Controls</a></li>
        
          <li><a href="./ControlsController.html">ControlsController</a></li>
        
          <li><a href="./DownloadHelper.html">DownloadHelper</a></li>
        
          <li><a href="./ErrorHelper.html">ErrorHelper</a></li>
        
          <li><a href="./GeoController.html">GeoController</a></li>
        
          <li><a href="./GeoHelper.html">GeoHelper</a></li>
        
          <li><a href="./Input4.html">Input4</a></li>
        
          <li><a href="./MethodHelper.html">MethodHelper</a></li>
        
          <li><a href="./MoreController.html">MoreController</a></li>
        
          <li><a href="./Movie.html">Movie</a></li>
        
          <li><a href="./MovieController.html">MovieController</a></li>
        
          <li><a href="./MovieHelper.html">MovieHelper</a></li>
        
          <li><a href="./ObjHelper.html">ObjHelper</a></li>
        
          <li><a href="./Object.html">Object</a></li>
        
          <li><a href="./Playlist4.html">Playlist4</a></li>
        
          <li><a href="./PlaylistController.html">PlaylistController</a></li>
        
          <li><a href="./PlaylistHelper.html">PlaylistHelper</a></li>
        
          <li><a href="./Product.html">Product</a></li>
        
          <li><a href="./ProductController.html">ProductController</a></li>
        
          <li><a href="./ProductHelper.html">ProductHelper</a></li>
        
          <li><a href="./SpecRunner.html">SpecRunner</a></li>
        
          <li><a href="./SpecRunnerController.html">SpecRunnerController</a></li>
        
          <li><a href="./TempClass.html">TempClass</a></li>
        
          <li><a href="./TvEpisodeHelper.html">TvEpisodeHelper</a></li>
        
          <li><a href="./TvSeasonHelper.html">TvSeasonHelper</a></li>
        
          <li><a href="./TvShowHelper.html">TvShowHelper</a></li>
        
          <li><a href="./Tvepisode.html">Tvepisode</a></li>
        
          <li><a href="./TvepisodeController.html">TvepisodeController</a></li>
        
          <li><a href="./Tvseason.html">Tvseason</a></li>
        
          <li><a href="./TvseasonController.html">TvseasonController</a></li>
        
          <li><a href="./Tvshow.html">Tvshow</a></li>
        
          <li><a href="./TvshowController.html">TvshowController</a></li>
        
          <li><a href="./VideoLibrary2.html">VideoLibrary2</a></li>
        
          <li><a href="./VideoLibrary4.html">VideoLibrary4</a></li>
        
          <li><a href="./XbmcAppHelper.html">XbmcAppHelper</a></li>
        
          <li><a href="./XbmcConfig.html">XbmcConfig</a></li>
        
          <li><a href="./XbmcConfigController.html">XbmcConfigController</a></li>
        
          <li><a href="./XbmcConfigHelper.html">XbmcConfigHelper</a></li>
        
          <li><a href="./XbmcController.html">XbmcController</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="module">TvSeasonHelper</h1>

    <div id="description" class="description">
      
<p>Helper for everything to do with TV Seasons.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      

      <!-- Methods -->
      
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="find_season-method" class="method-detail ">
          <a name="method-i-find_season"></a>

          
          <div class="method-heading">
            <span class="method-name">find_season</span><span
              class="method-args">(seasonid, tvshowid)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Finds a single Season based upon a XBMC Library ID for Season and TV Show. 
It is filtered by the current active XBMC Configuration</p>
            

            
            <div class="method-source-code" id="find_season-source">
<pre>
<span class="ruby-comment"># File app/helpers/tv_season_helper.rb, line 19</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">find_season</span>(<span class="ruby-identifier">seasonid</span>, <span class="ruby-identifier">tvshowid</span>)
  <span class="ruby-constant">Tvseason</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">:first</span>, <span class="ruby-value">:conditions</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value">:xbmc_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">XbmcConfigHelper</span>.<span class="ruby-identifier">current_config</span>.<span class="ruby-identifier">object</span>, <span class="ruby-value">:tvshow_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">tvshowid</span>, <span class="ruby-value">:xlib_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">seasonid</span>})
<span class="ruby-keyword">end</span></pre>
            </div><!-- find_season-source -->
            
          </div>

          

          
        </div><!-- find_season-method -->

      
        <div id="find_seasons-method" class="method-detail ">
          <a name="method-i-find_seasons"></a>

          
          <div class="method-heading">
            <span class="method-name">find_seasons</span><span
              class="method-args">(tvshowid)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Retrieves an array of Seasons for the given TV Show ID. Filtered by the
current active XBMC configuration.</p>
            

            
            <div class="method-source-code" id="find_seasons-source">
<pre>
<span class="ruby-comment"># File app/helpers/tv_season_helper.rb, line 24</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">find_seasons</span>(<span class="ruby-identifier">tvshowid</span>)
  <span class="ruby-constant">Tvseason</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">:all</span>, <span class="ruby-value">:conditions</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value">:xbmc_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">XbmcConfigHelper</span>.<span class="ruby-identifier">current_config</span>.<span class="ruby-identifier">object</span>, <span class="ruby-value">:tvshow_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">tvshowid</span>})
<span class="ruby-keyword">end</span></pre>
            </div><!-- find_seasons-source -->
            
          </div>

          

          
        </div><!-- find_seasons-method -->

      
        <div id="handle_new_seasons-method" class="method-detail ">
          <a name="method-i-handle_new_seasons"></a>

          
          <div class="method-heading">
            <span class="method-name">handle_new_seasons</span><span
              class="method-args">(seasons)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Adds new TV Seasons. found in the XBMC library that aren’t in the Remote’s
library.</p>
            

            
            <div class="method-source-code" id="handle_new_seasons-source">
<pre>
<span class="ruby-comment"># File app/helpers/tv_season_helper.rb, line 52</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">handle_new_seasons</span>(<span class="ruby-identifier">seasons</span>)
  <span class="ruby-identifier">list_changed</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">seasons</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">new_season</span> <span class="ruby-operator">|</span>
    <span class="ruby-identifier">found</span> = <span class="ruby-identifier">find_season</span>(<span class="ruby-identifier">new_season</span>[<span class="ruby-value">:season</span>], <span class="ruby-identifier">new_season</span>[<span class="ruby-value">:tvshowid</span>])
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">found</span>.<span class="ruby-identifier">blank?</span>
      <span class="ruby-identifier">n_season</span> = <span class="ruby-constant">Tvseason</span>.<span class="ruby-identifier">new</span>(
        <span class="ruby-value">:xbmc_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">XbmcConfigHelper</span>.<span class="ruby-identifier">current_config</span>.<span class="ruby-identifier">object</span>, 
        <span class="ruby-value">:xlib_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">new_season</span>[<span class="ruby-value">:season</span>], 
        <span class="ruby-value">:tvshow_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">new_season</span>[<span class="ruby-value">:tvshowid</span>], 
        <span class="ruby-value">:label</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">new_season</span>[<span class="ruby-value">:label</span>], 
        <span class="ruby-value">:showtitle</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">new_season</span>[<span class="ruby-value">:showtitle</span>], 
        <span class="ruby-value">:thumb</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">new_season</span>[<span class="ruby-value">:thumbnail</span>], 
        <span class="ruby-value">:fanart</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">new_season</span>[<span class="ruby-value">:fanart</span>])
      
      <span class="ruby-identifier">n_season</span>.<span class="ruby-identifier">url</span> = <span class="ruby-node">&quot;/app/Tvepisode?tvshowid=#{new_season[:tvshowid]}&amp;tvseasonid=#{new_season[:season]}&quot;</span>
      
      <span class="ruby-identifier">n_season</span>.<span class="ruby-identifier">save</span>
      
      <span class="ruby-identifier">list_changed</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">list_changed</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- handle_new_seasons-source -->
            
          </div>

          

          
        </div><!-- handle_new_seasons-method -->

      
        <div id="handle_removed_seasons-method" class="method-detail ">
          <a name="method-i-handle_removed_seasons"></a>

          
          <div class="method-heading">
            <span class="method-name">handle_removed_seasons</span><span
              class="method-args">(xbmc_tvseasons, tvshowid)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Removes any TV Seasons that are in the Remote’s library but not in the
XBMC’s Library Deletes the episodes if a Season has been removed.</p>
            

            
            <div class="method-source-code" id="handle_removed_seasons-source">
<pre>
<span class="ruby-comment"># File app/helpers/tv_season_helper.rb, line 78</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">handle_removed_seasons</span>(<span class="ruby-identifier">xbmc_tvseasons</span>, <span class="ruby-identifier">tvshowid</span>)
  <span class="ruby-identifier">list_changed</span> = <span class="ruby-keyword">false</span> 
  
  <span class="ruby-identifier">find_seasons</span>(<span class="ruby-identifier">tvshowid</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">db_season</span> <span class="ruby-operator">|</span>
    <span class="ruby-identifier">got</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-identifier">xbmc_tvseasons</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">xb_season</span> <span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">db_season</span>.<span class="ruby-identifier">xlib_id</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">xb_season</span>[<span class="ruby-value">:season</span>].<span class="ruby-identifier">to_i</span>
        <span class="ruby-identifier">got</span> = <span class="ruby-keyword">true</span> 
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">got</span>
      <span class="ruby-identifier">episodes</span> = <span class="ruby-identifier">find_episodes</span>(<span class="ruby-identifier">db_season</span>.<span class="ruby-identifier">xlib_id</span>, <span class="ruby-identifier">tvshowid</span>)
      <span class="ruby-identifier">episodes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">episode</span> <span class="ruby-operator">|</span>
        <span class="ruby-identifier">episode</span>.<span class="ruby-identifier">destroy_image</span>
        <span class="ruby-identifier">episode</span>.<span class="ruby-identifier">destroy</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-identifier">db_season</span>.<span class="ruby-identifier">destroy_image</span>
      <span class="ruby-identifier">db_season</span>.<span class="ruby-identifier">destroy</span>
      <span class="ruby-identifier">list_changed</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">list_changed</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- handle_removed_seasons-source -->
            
          </div>

          

          
        </div><!-- handle_removed_seasons-method -->

      
        <div id="sync_seasons-method" class="method-detail ">
          <a name="method-i-sync_seasons"></a>

          
          <div class="method-heading">
            <span class="method-name">sync_seasons</span><span
              class="method-args">(xbmc_seasons, tvshowid)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>General method to sync tv seasons. The parameter is the list in the XBMC
JSON RPC format. Return either True or False if the list has been updated.
If there no seasons, delete all the episodes associated</p>
            

            
            <div class="method-source-code" id="sync_seasons-source">
<pre>
<span class="ruby-comment"># File app/helpers/tv_season_helper.rb, line 31</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">sync_seasons</span>(<span class="ruby-identifier">xbmc_seasons</span>, <span class="ruby-identifier">tvshowid</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">xbmc_seasons</span>.<span class="ruby-identifier">blank?</span>
    <span class="ruby-identifier">res</span> = <span class="ruby-identifier">handle_new_seasons</span>(<span class="ruby-identifier">xbmc_seasons</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">handle_removed_seasons</span>(<span class="ruby-identifier">xbmc_seasons</span>, <span class="ruby-identifier">tvshowid</span>)
    <span class="ruby-identifier">update_episodes</span>(<span class="ruby-identifier">tvshowid</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">seasons</span> = <span class="ruby-identifier">find_seasons</span>(<span class="ruby-identifier">tvshowid</span>)
    <span class="ruby-identifier">seasons</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">season</span> <span class="ruby-operator">|</span>
      <span class="ruby-identifier">episodes</span> = <span class="ruby-identifier">find_episodes</span>(<span class="ruby-identifier">season</span>.<span class="ruby-identifier">xlib_id</span>, <span class="ruby-identifier">tvshowid</span>)
      <span class="ruby-identifier">episodes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">episode</span> <span class="ruby-operator">|</span>
        <span class="ruby-identifier">episode</span>.<span class="ruby-identifier">destroy_image</span>
        <span class="ruby-identifier">episode</span>.<span class="ruby-identifier">destroy</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">season</span>.<span class="ruby-identifier">destroy_image</span>
      <span class="ruby-identifier">season</span>.<span class="ruby-identifier">destroy</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">res</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">res</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- sync_seasons-source -->
            
          </div>

          

          
        </div><!-- sync_seasons-method -->

      
        <div id="update_episodes-method" class="method-detail ">
          <a name="method-i-update_episodes"></a>

          
          <div class="method-heading">
            <span class="method-name">update_episodes</span><span
              class="method-args">(tvshowid)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Selects the JSON API from the Current XBMC Configuration Only version 3/4
of JSON API is supported. Updates all the episodes for the TV Show</p>
            

            
            <div class="method-source-code" id="update_episodes-source">
<pre>
<span class="ruby-comment"># File app/helpers/tv_season_helper.rb, line 107</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">update_episodes</span>(<span class="ruby-identifier">tvshowid</span>)
  <span class="ruby-identifier">version</span> = <span class="ruby-constant">XbmcConfigHelper</span>.<span class="ruby-identifier">current_config</span>.<span class="ruby-identifier">version</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">version</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">version</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Api</span><span class="ruby-operator">::</span><span class="ruby-constant">V4</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span>)  <span class="ruby-operator">||</span> (<span class="ruby-identifier">version</span> <span class="ruby-operator">==</span> <span class="ruby-value">3</span>)
      <span class="ruby-identifier">seasons</span> = <span class="ruby-identifier">find_seasons</span>(<span class="ruby-identifier">tvshowid</span>)
      <span class="ruby-keyword">unless</span> <span class="ruby-identifier">seasons</span>.<span class="ruby-identifier">blank?</span>
        <span class="ruby-identifier">seasons</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">season</span> <span class="ruby-operator">|</span>
          <span class="ruby-identifier">url_cb</span> = <span class="ruby-identifier">url_for</span>(
            <span class="ruby-value">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:Tvepisode</span>, 
            <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:episodes_callback</span>, 
            <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> {
              <span class="ruby-value">:tvshowid</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">season</span>.<span class="ruby-identifier">tvshow_id</span>,
              <span class="ruby-value">:tvseasonid</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">season</span>.<span class="ruby-identifier">xlib_id</span>
            })
          <span class="ruby-identifier">send_command</span> { <span class="ruby-constant">Api</span><span class="ruby-operator">::</span><span class="ruby-constant">V4</span><span class="ruby-operator">::</span><span class="ruby-constant">VideoLibrary</span>.<span class="ruby-identifier">get_episodes</span>(<span class="ruby-identifier">url_cb</span>, <span class="ruby-identifier">season</span>.<span class="ruby-identifier">tvshow_id</span>, <span class="ruby-identifier">season</span>.<span class="ruby-identifier">xlib_id</span>) }
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- update_episodes-source -->
            
          </div>

          

          
        </div><!-- update_episodes-method -->

      
        <div id="update_seasons_helper-method" class="method-detail ">
          <a name="method-i-update_seasons_helper"></a>

          
          <div class="method-heading">
            <span class="method-name">update_seasons_helper</span><span
              class="method-args">(callback, tvshowid)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Selects the JSON API from the Current XBMC Configuration Only version 3/4
of JSON API is supported. Requests to update the seasons for the given TV
Show.</p>
            

            
            <div class="method-source-code" id="update_seasons_helper-source">
<pre>
<span class="ruby-comment"># File app/helpers/tv_season_helper.rb, line 131</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">update_seasons_helper</span>(<span class="ruby-identifier">callback</span>, <span class="ruby-identifier">tvshowid</span>)
  <span class="ruby-identifier">version</span> = <span class="ruby-constant">XbmcConfigHelper</span>.<span class="ruby-identifier">current_config</span>.<span class="ruby-identifier">version</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">version</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">version</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Api</span><span class="ruby-operator">::</span><span class="ruby-constant">V4</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span>)  <span class="ruby-operator">||</span> (<span class="ruby-identifier">version</span> <span class="ruby-operator">==</span> <span class="ruby-value">3</span>)
      <span class="ruby-constant">Api</span><span class="ruby-operator">::</span><span class="ruby-constant">V4</span><span class="ruby-operator">::</span><span class="ruby-constant">VideoLibrary</span>.<span class="ruby-identifier">get_seasons</span>(<span class="ruby-identifier">callback</span>, <span class="ruby-identifier">tvshowid</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- update_seasons_helper-source -->
            
          </div>

          

          
        </div><!-- update_seasons_helper-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

